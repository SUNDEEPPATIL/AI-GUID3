import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useMemo } from 'react';
import StarRating from './StarRating';
import RupeeIcon from './icons/RupeeIcon';
import CalendarIcon from './icons/CalendarIcon';
import ScaleIcon from './icons/ScaleIcon';
import MedalIcon from './icons/MedalIcon';
import HeartIcon from './icons/HeartIcon';
import ShareIcon from './icons/ShareIcon';
import Tooltip from './Tooltip';
import { findBestRetailerPrice, createPurchaseLink } from '../utils';
import ShoppingBagIcon from './icons/ShoppingBagIcon';
import StarIcon from './icons/StarIcon';
import RocketIcon from './icons/RocketIcon';
const ProductCard = ({ product, onViewDetails, onToggleCompare, isInCompare, compareDisabled, isBestValue, isBestPerformance, onToggleWishlist, isWishlisted, onShare }) => {
    const price = product.priceInINR || product.expectedPriceInINR;
    const priceLabel = product.priceInINR ? 'Price' : 'Expected Price';
    const ariaLabelId = `product-card-title-${product.modelName.replace(/\s+/g, '-')}`;
    const borderClass = isBestValue
        ? 'border-amber-400 shadow-2xl shadow-amber-500/10'
        : isBestPerformance
            ? 'border-purple-500 shadow-2xl shadow-purple-500/10'
            : isInCompare
                ? 'border-cyan-500/80 shadow-2xl shadow-cyan-500/10'
                : 'border-gray-700/50 hover:border-cyan-500/50';
    const bestPriceInfo = useMemo(() => findBestRetailerPrice(product.retailerPrices || []), [product.retailerPrices]);
    return (_jsxs("article", { "aria-labelledby": ariaLabelId, className: `relative bg-gray-800 rounded-xl border overflow-hidden flex flex-col transition-all duration-300 ${borderClass}`, children: [isBestPerformance && (_jsx(Tooltip, { text: "AI's Best Performance Pick: Top-tier specs and features.", children: _jsxs("div", { className: "absolute top-0 left-0 bg-purple-500 text-white text-xs font-bold px-2 py-1 rounded-br-lg rounded-tl-xl flex items-center gap-1 z-10", children: [_jsx(RocketIcon, { className: "w-4 h-4" }), "Best Performance"] }) })), isBestValue && (_jsx(Tooltip, { text: "AI's Best Value Pick: A top combination of high ratings and low price.", children: _jsxs("div", { className: "absolute top-0 right-0 bg-amber-400 text-gray-900 text-xs font-bold px-2 py-1 rounded-bl-lg rounded-tr-xl flex items-center gap-1 z-10", children: [_jsx(MedalIcon, { className: "w-4 h-4" }), "Best Value"] }) })), _jsxs("div", { className: "p-5 flex-grow pt-10", children: [_jsx("h3", { className: "text-lg font-bold text-white truncate", children: product.brand }), _jsx("h4", { id: ariaLabelId, className: "text-md text-gray-300 mb-2 truncate", children: product.modelName }), _jsxs("div", { className: "flex items-center gap-2 mb-3", children: [_jsx(StarRating, { rating: product.reviewStars }), product.totalReviews && (_jsxs("span", { className: "text-xs text-gray-400 mt-0.5", children: ["(", product.totalReviews.toLocaleString(), " reviews)"] }))] }), _jsx("p", { className: "text-sm text-gray-400 line-clamp-2 mb-4 h-[40px]", children: product.summary }), _jsxs("div", { className: "space-y-2 text-sm", children: [price && (_jsxs("div", { className: "flex items-center gap-2 text-gray-300", children: [_jsx(RupeeIcon, { className: "w-4 h-4 text-cyan-400" }), _jsxs("span", { children: [priceLabel, ": ", _jsx("span", { className: "font-semibold text-white", children: price })] })] })), product.launchYear && (_jsxs("div", { className: "flex items-center gap-2 text-gray-300", children: [_jsx(CalendarIcon, { className: "w-4 h-4 text-cyan-400" }), _jsxs("span", { children: ["Launched: ", _jsx("span", { className: "font-semibold text-white", children: product.launchYear })] })] })), product.expectedLaunch && !product.launchYear && (_jsxs("div", { className: "flex items-center gap-2 text-gray-300", children: [_jsx(CalendarIcon, { className: "w-4 h-4 text-cyan-400" }), _jsxs("span", { children: ["Launch: ", _jsx("span", { className: "font-semibold text-white", children: product.expectedLaunch })] })] })), product.keySpecs && product.keySpecs.length > 0 && (_jsx("div", { className: "pt-3 mt-3 border-t border-gray-700/50 space-y-1", children: product.keySpecs.slice(0, 3).map((spec, index) => (_jsxs("div", { className: "flex items-start gap-1.5 truncate", children: [_jsx(StarIcon, { className: "w-4 h-4 text-cyan-400/80 flex-shrink-0 mt-0.5", "aria-hidden": "true" }), _jsx("span", { className: "text-gray-300", children: spec })] }, index))) }))] })] }), _jsxs("footer", { className: "p-4 bg-gray-800/50 border-t border-gray-700/50 mt-auto flex items-center gap-2", children: [_jsx(Tooltip, { text: "See more details about this product", children: _jsx("button", { onClick: onViewDetails, className: "flex-1 bg-cyan-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-cyan-500 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-cyan-400", children: "View Details" }) }), bestPriceInfo && (_jsx(Tooltip, { text: `Shop on ${bestPriceInfo.retailerName} (best price listed: ${bestPriceInfo.price})`, children: _jsx("a", { href: createPurchaseLink(bestPriceInfo, product), target: "_blank", rel: "noopener noreferrer", className: "p-2 rounded-lg text-white transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 bg-green-600 hover:bg-green-500 focus:ring-green-400", "aria-label": `Search for product on ${bestPriceInfo.retailerName}`, children: _jsx(ShoppingBagIcon, { className: "w-6 h-6" }) }) })), _jsx(Tooltip, { text: "Share this product", children: _jsx("button", { onClick: () => onShare(product), className: "p-2 rounded-lg bg-gray-700 hover:bg-gray-600 text-gray-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-cyan-400", "aria-label": "Share product", children: _jsx(ShareIcon, { className: "w-6 h-6" }) }) }), _jsx(Tooltip, { text: isWishlisted ? "Remove from wishlist" : "Add to wishlist", children: _jsx("button", { onClick: () => onToggleWishlist(product), className: `p-2 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-pink-400 ${isWishlisted
                                ? 'bg-pink-500/20 text-pink-300'
                                : 'bg-gray-700 hover:bg-gray-600 text-gray-300'}`, "aria-label": isWishlisted ? "Remove from wishlist" : "Add to wishlist", children: _jsx(HeartIcon, { className: "w-6 h-6", filled: isWishlisted }) }) }), _jsx(Tooltip, { text: compareDisabled ? "Compare list is full (max 3)" : (isInCompare ? "Remove from compare" : "Add to compare"), children: _jsx("button", { onClick: () => onToggleCompare(product), disabled: compareDisabled, className: `p-2 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-cyan-400 ${isInCompare
                                ? 'bg-cyan-500/20 text-cyan-300'
                                : 'bg-gray-700 hover:bg-gray-600 text-gray-300'} ${compareDisabled ? 'opacity-50 cursor-not-allowed' : ''}`, "aria-label": isInCompare ? "Remove from compare" : "Add to compare", children: _jsx(ScaleIcon, { className: "w-6 h-6" }) }) })] })] }));
};
export default ProductCard;
